<dein vollständiger und überarbeiteter Code von oben>